<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="author" content="Co-authored: Brian Wong, Justin Tsuchiyama, Tyler Luk">
    <meta name="description" content="Website to schedule stuff.">
    <link href="styles/styles.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="images/CalendarIcon.ico">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <title>Scheduler</title>
    
    <!-- CALENDAR STUFF -->
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar-scheduler@5.6.0/main.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.6.0/main.min.js'></script>
  </head>
  <body>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-storage.js"></script>
    
    <script>
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      var firebaseConfig = {
        apiKey: "AIzaSyC1rvN3zf0_W9Vz_oq-TTFY6-g5-XyyXOY",
        authDomain: "schdlr-b3435.firebaseapp.com",
        projectId: "schdlr-b3435",
        storageBucket: "schdlr-b3435.appspot.com",
        messagingSenderId: "787536569268",
        appId: "1:787536569268:web:1f2966c2622f1a347a48e1",
        measurementId: "G-95FKY6HTYT"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
      firebase.analytics();
      const auth = firebase.auth();
    </script>
    <script src="scripts/User.js"></script>
    <script src="scripts/main.js"></script>

    <!-- Navbar -->
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="home.html">Scheduler</a>
        </div>
        <ul class="nav navbar-nav">
          <li><a href="#">Profile</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="index.html" onclick="signOut()"><span class="glyphicon glyphicon-log-out"></span> Sign Out</a></li>
        </ul>
        <!-- Search Bar -->
        <div class="dropdown nav navbar-nav navbar-right">
          <button onclick="searchDropdown()" class="dropbtn">Search</button>
          <div id="myDropdown" class="dropdown-content">
            <input type="text" placeholder="Search.." id="myInput">
            <ul class="list-group" id="peopleList"></ul>
          </div>
        </div>
      </div>
    </nav>

    <!-- Content -->
    <div class="content">
        <p>Select a time period for event: </p>
        <p>Green = Open, Red = Busy</p>
        <div id='overlapCalendar'></div>
    </div> 


    <!-- SCRIPT FOR CALENDAR HERE -->
    <script type="text/javascript">
      // Client ID and API key from the Developer Console
      var CLIENT_ID = '787536569268-elefuvio2stdcvvn58aociq5ijb84t6t.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyC1rvN3zf0_W9Vz_oq-TTFY6-g5-XyyXOY';

      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = "https://www.googleapis.com/auth/calendar";

      /*function authenticate() {
        return gapi.auth2.getAuthInstance()
            .signIn({scope: SCOPES})
            .then(function() { console.log("Sign-in successful"); },
                  function(err) { console.error("Error signing in", err); });
      }*/

      function loadClient() {
        gapi.client.setApiKey(API_KEY);
        return gapi.client.load("https://content.googleapis.com/discovery/v1/apis/calendar/v3/rest")
            .then(function() { console.log("GAPI client loaded for API"); },
                  function(err) { console.error("Error loading GAPI client for API", err); });
      }

      gapi.load("client:auth2", function() {
        gapi.auth2.init({client_id: CLIENT_ID});
      });

      function executeBusyList() {
        return gapi.client.calendar.freebusy.query({
          "resource": {
            "timeMin": '2021-05-11T12:00:00-07:00',
            "timeMax": '2021-05-12T12:00:00-07:00',
            "timeZone": 'America/Los_Angeles',
            "items": [
              {
                id: 'jtsuch1122@gmail.com'
              }
            ]
          }
        }).then(function(response) {
          // Handle the results here (response.result has the parsed body).
          console.log("Response", response);
        },
        function(err) { console.error("Execute error", err); 
        });
      }
      /**
       *  On load, called to load the auth2 library and API client library.
       */
      //function handleClientLoad() {
        //gapi.load('client:auth2', initClient);
      //}

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       *
      var auth2;
      function initClient() {
        auth2 = gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
          console.log("Inside of initClient()");

        }, function(error) {
          //appendPre(JSON.stringify(error, null, 2));
          console.log("initClient Failed");
        });
      }

      function onFailure() {
        console.log("Failed to work right");
      }*/

    </script>

    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};loadClient()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
    <!-- END OF CALENDAR API -->


    <footer>
      <p>Â©Copyright 2050 by nobody. All rights reversed.</p>
    </footer>
  </body>
</html> 
